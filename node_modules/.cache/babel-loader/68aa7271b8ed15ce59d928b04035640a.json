{"ast":null,"code":"import { updateAvatarAPI } from '@/api';\nexport default {\n  name: 'my-user',\n\n  data() {\n    return {\n      // 保存照片的链接--base64字符串\n      avatar: '',\n      // 表单数据部分\n      ruleForm: {\n        name: '',\n        age: '',\n        birthday: '',\n        briefInfo: '',\n        contact: '',\n        area: ''\n      },\n      rules: {\n        name: [{\n          required: true,\n          message: '姓名',\n          trigger: 'blur'\n        } // { min: 3, max: 5, message: '长度在 3 到 5 个字符', trigger: 'blur' }\n        ],\n        birthday: [{\n          required: true,\n          message: '生日',\n          trigger: 'blur'\n        } // { min: 3, max: 5, message: '长度在 3 到 5 个字符', trigger: 'blur' }\n        ],\n        briefInfo: [{\n          required: true,\n          message: '简介',\n          trigger: 'blur'\n        } // { min: 3, max: 5, message: '长度在 3 到 5 个字符', trigger: 'blur' }\n        ],\n        contact: [{\n          required: true,\n          message: '联系方式',\n          trigger: 'blur'\n        } // { min: 3, max: 5, message: '长度在 3 到 5 个字符', trigger: 'blur' }\n        ],\n        area: [{\n          required: true,\n          message: '地区',\n          trigger: 'blur'\n        } // { min: 3, max: 5, message: '长度在 3 到 5 个字符', trigger: 'blur' }\n        ]\n      }\n    };\n  },\n\n  methods: {\n    // 点击选择头像\n    chooseImg() {\n      // 模拟点击事件\n      this.$refs.iptRef.click();\n    },\n\n    // 选择完图片后要读取该文件，然后转化格式\n    onFileChange(e) {\n      // 获取文件信息\n      const files = e.target.files; // 没获取到\n\n      if (files[0].length === 0) {\n        this.avatar = '';\n      } else {\n        const fr = new FileReader();\n        fr.readAsDataURL(files[0]);\n\n        fr.onload = e => {\n          // 在展示区展示\n          this.avatar = e.target.result;\n        };\n      }\n    },\n\n    // 更新后台头像信息\n    async uploadFnImg() {\n      const {\n        data: res\n      } = await updateAvatarAPI(this.avatar);\n\n      if (res.code === 0) {\n        this.$message.success(res.message); // 更新个人信息\n\n        this.$store.dispatch('initUserInfo');\n      } else {\n        this.$message.error(res.message);\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAyCA;AACA;EACAA,eADA;;EAEAC;IACA;MACA;MACAC,UAFA;MAGA;MACAC;QACAH,QADA;QAEAI,OAFA;QAGAC,YAHA;QAIAC,aAJA;QAKAC,WALA;QAMAC;MANA,CAJA;MAYAC;QACAT,OACA;UAAAU;UAAAC;UAAAC;QAAA,CADA,CAEA;QAFA,CADA;QAKAP,WACA;UAAAK;UAAAC;UAAAC;QAAA,CADA,CAEA;QAFA,CALA;QASAN,YACA;UAAAI;UAAAC;UAAAC;QAAA,CADA,CAEA;QAFA,CATA;QAaAL,UACA;UAAAG;UAAAC;UAAAC;QAAA,CADA,CAEA;QAFA,CAbA;QAiBAJ,OACA;UAAAE;UAAAC;UAAAC;QAAA,CADA,CAEA;QAFA;MAjBA;IAZA;EAmCA,CAtCA;;EAuCAC;IACA;IACAC;MACA;MACA;IACA,CALA;;IAMA;IACAC;MACA;MACA,6BAFA,CAGA;;MACA;QACA;MACA,CAFA,MAEA;QACA;QACAC;;QACAA;UACA;UACA;QACA,CAHA;MAIA;IACA,CArBA;;IAsBA;IACA;MACA;QAAAf;MAAA;;MACA;QACA,mCADA,CAEA;;QACA;MACA,CAJA,MAIA;QACA;MACA;IACA;;EAhCA;AAvCA","names":["name","data","avatar","ruleForm","age","birthday","briefInfo","contact","area","rules","required","message","trigger","methods","chooseImg","onFileChange","fr"],"sourceRoot":"src/views/routes","sources":["my-user.vue"],"sourcesContent":["<template>\r\n  <div class=\"my-user\">\r\n    <!-- 头像编辑功能 -->\r\n      <div class=\"photo-config\">\r\n        <img src=\"../../assets/images/用户头像.png\" alt=\"\" v-if=\"!avatar\" class=\"the_img\">\r\n        <img :src=\"avatar\" alt=\"\" v-else class=\"the_img\">\r\n        <!--  -->\r\n\r\n        <input type=\"file\" style=\"display:none\" ref=\"iptRef\" @change=\"onFileChange\" accept=\"image/*\">\r\n        <div class=\"avatar_btn\" @click=\"chooseImg\">\r\n            <img src=\"../../assets/images/编辑图标.png\" alt=\"\" >\r\n            <span>编辑头像</span>\r\n        </div>\r\n        <!-- 保存到后台头像信息 -->\r\n        <div class=\"avatar_btn\"  @click=\"uploadFnImg\">\r\n            <img src=\"../../assets/images/编辑图标.png\" alt=\"\" >\r\n            <span>保存头像</span>\r\n        </div>\r\n\r\n      </div>\r\n      <!-- 基本信息编辑功能 -->\r\n      <div class=\"info-config\">\r\n          <!-- 标题 -->\r\n          <div class=\"info-config-title\"><span>基本信息</span></div>\r\n          <!-- 表单 -->\r\n          <div class=\"info-config-edit\">\r\n              <el-form :model=\"ruleForm\" :rules=\"rules\" ref=\"ruleForm\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n                  <el-form-item  prop=\"name\" label=\"姓名：\"><el-input v-model=\"ruleForm.name\"></el-input></el-form-item>\r\n                  <el-form-item  prop=\"name\" label=\"性别：\"><el-radio v-model=\"ruleForm.age\" label=\"1\">男</el-radio><el-radio v-model=\"ruleForm.age\" label=\"2\">女</el-radio></el-form-item>\r\n                  <el-form-item  prop=\"birthday\"  label=\"出生日期：\"><el-date-picker type=\"date\" placeholder=\"选择日期\" v-model=\"ruleForm.birthday\" style=\"width: 100%;\"></el-date-picker></el-form-item>\r\n                  <el-form-item  prop=\"briefInfo\" label=\"简介：\"><el-input v-model=\"ruleForm.briefInfo\"></el-input></el-form-item>\r\n                  <el-form-item  prop=\"contact\" label=\"联系方式：\"><el-input v-model=\"ruleForm.contact\"></el-input></el-form-item>\r\n                  <el-form-item  prop=\"area\"  label=\"地区：\"><el-input v-model=\"ruleForm.area\"></el-input></el-form-item>\r\n                  <el-form-item><el-button type=\"primary\">保存</el-button></el-form-item>\r\n              </el-form>\r\n          </div>\r\n      </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { updateAvatarAPI } from '@/api'\r\nexport default {\r\n  name: 'my-user',\r\n  data () {\r\n    return {\r\n      // 保存照片的链接--base64字符串\r\n      avatar: '',\r\n      // 表单数据部分\r\n      ruleForm: {\r\n        name: '',\r\n        age: '',\r\n        birthday: '',\r\n        briefInfo: '',\r\n        contact: '',\r\n        area: ''\r\n      },\r\n      rules: {\r\n        name: [\r\n          { required: true, message: '姓名', trigger: 'blur' }\r\n          // { min: 3, max: 5, message: '长度在 3 到 5 个字符', trigger: 'blur' }\r\n        ],\r\n        birthday: [\r\n          { required: true, message: '生日', trigger: 'blur' }\r\n          // { min: 3, max: 5, message: '长度在 3 到 5 个字符', trigger: 'blur' }\r\n        ],\r\n        briefInfo: [\r\n          { required: true, message: '简介', trigger: 'blur' }\r\n          // { min: 3, max: 5, message: '长度在 3 到 5 个字符', trigger: 'blur' }\r\n        ],\r\n        contact: [\r\n          { required: true, message: '联系方式', trigger: 'blur' }\r\n          // { min: 3, max: 5, message: '长度在 3 到 5 个字符', trigger: 'blur' }\r\n        ],\r\n        area: [\r\n          { required: true, message: '地区', trigger: 'blur' }\r\n          // { min: 3, max: 5, message: '长度在 3 到 5 个字符', trigger: 'blur' }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    // 点击选择头像\r\n    chooseImg () {\r\n      // 模拟点击事件\r\n      this.$refs.iptRef.click()\r\n    },\r\n    // 选择完图片后要读取该文件，然后转化格式\r\n    onFileChange (e) {\r\n      // 获取文件信息\r\n      const files = e.target.files\r\n      // 没获取到\r\n      if (files[0].length === 0) {\r\n        this.avatar = ''\r\n      } else {\r\n        const fr = new FileReader()\r\n        fr.readAsDataURL(files[0])\r\n        fr.onload = e => {\r\n          // 在展示区展示\r\n          this.avatar = e.target.result\r\n        }\r\n      }\r\n    },\r\n    // 更新后台头像信息\r\n    async uploadFnImg () {\r\n      const { data: res } = await updateAvatarAPI(this.avatar)\r\n      if (res.code === 0) {\r\n        this.$message.success(res.message)\r\n        // 更新个人信息\r\n        this.$store.dispatch('initUserInfo')\r\n      } else {\r\n        this.$message.error(res.message)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.my-user{\r\n  width: 90%;\r\n  height: 95%;\r\n  background-color: rgb(255, 255, 255);\r\n  border-radius: 1rem;\r\n  //水平垂直\r\n  margin: 0 auto;\r\n  //头像设置\r\n  .photo-config{\r\n    padding-top: 5%;\r\n    height: 15%;\r\n    padding-left: 12rem;\r\n    >*{\r\n      display: inline-block;\r\n    }\r\n    .the_img{\r\n      border: 1px solid black;\r\n      width: 88px;\r\n      height: 89px;\r\n    }\r\n    .avatar_btn{\r\n      border: 1px solid black;\r\n      margin-left: 3rem;\r\n      img{\r\n      width: 15px;\r\n      height: 15px;\r\n      }\r\n    }\r\n    .avatar_btn:hover{\r\n      cursor: pointer;\r\n    }\r\n  }\r\n  .info-config{\r\n    margin-left: 10%;\r\n    margin-top: 7%;\r\n    height: 73%;\r\n    .info-config-title{\r\n      border-left: 8px rgb(1, 142, 237) solid;\r\n      span{\r\n        margin-left: 13px;\r\n      }\r\n    }\r\n    .info-config-edit{\r\n      margin-top: 57px;\r\n      .demo-ruleForm{\r\n        display: flex;\r\n        flex-direction: row;\r\n        flex-wrap: wrap;\r\n      }\r\n    }\r\n  }\r\n}\r\n.el-input{\r\n  // height: 200px;\r\n}\r\n.el-input__inner{\r\n\r\n  // height: 40% ;\r\n}\r\n.el-form-item{\r\n  width: 40%;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}