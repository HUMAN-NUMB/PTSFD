{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport '@/assets/font/font.css';\nimport * as echarts from 'echarts';\nimport { getTestFromYiYan, getScoreAndCount, UpdateTokenAPI } from '@/api';\nexport default {\n  name: 'my-main',\n\n  data() {\n    return {\n      left_span: '',\n      // 表格数据\n      sectorSc: [{\n        value: 0,\n        name: '<60'\n      }, {\n        value: 0,\n        name: '60~70'\n      }, {\n        value: 0,\n        name: '70~80'\n      }, {\n        value: 0,\n        name: '80~90'\n      }, {\n        value: 0,\n        name: '90~100'\n      }],\n      score_arr: [],\n      times_arr: [],\n      myChart: null,\n      myNextChart: null\n    };\n  },\n\n  methods: {\n    // 判断数据所处范围进行填充\n    sectorDataFill(score) {\n      switch (true) {\n        case score < 60:\n          this.sectorSc[0].value++;\n          break;\n\n        case score >= 60 && score <= 70:\n          this.sectorSc[1].value++;\n          break;\n\n        case score > 70 && score <= 80:\n          this.sectorSc[2].value++;\n          break;\n\n        case score > 80 && score <= 90:\n          this.sectorSc[3].value++;\n          break;\n\n        case score > 90 && score <= 100:\n          this.sectorSc[4].value++;\n          break;\n      } // console.log(this.sectorSc)\n\n    }\n\n  },\n\n  async mounted() {\n    const newToken = await UpdateTokenAPI(this.$store.state.refresh);\n    console.log(newToken); // 获取一言\n\n    const res = await getTestFromYiYan();\n    console.log(res.data);\n    this.left_span = res.data; // 获取次数和分数\n\n    const {\n      data: res1\n    } = await getScoreAndCount(); // 数据填入\n\n    for (const item of res1) {\n      this.score_arr.push(item.score);\n      this.times_arr.push(item.times);\n      this.sectorDataFill(item.score);\n    }\n\n    console.log(this.score_arr, this.times_arr); // 基于准备好的dom，初始化echarts实例\n\n    const myChart = echarts.init(document.getElementById('photoFirst')); // 绘制图表\n\n    myChart.setOption({\n      title: {\n        text: '预测报告树状图分析结果'\n      },\n      tooltip: {},\n      xAxis: {\n        data: this.times_arr,\n        name: '次数'\n      },\n      yAxis: {\n        name: '分数'\n      },\n      series: [{\n        name: '销量',\n        type: 'bar',\n        data: this.score_arr\n      }]\n    });\n    const myNextChart = echarts.init(document.getElementById('photoSeconed'));\n    myNextChart.setOption({\n      title: {\n        text: '预测报告扇形图分析结果',\n        subtext: '分数范围',\n        left: 'center'\n      },\n      tooltip: {\n        trigger: 'item'\n      },\n      legend: {\n        orient: 'vertical',\n        left: 'left'\n      },\n      series: [{\n        name: 'Access From',\n        type: 'pie',\n        radius: '50%',\n        data: this.sectorSc,\n        emphasis: {\n          itemStyle: {\n            shadowBlur: 10,\n            shadowOffsetX: 0,\n            shadowColor: 'rgba(0, 0, 0, 0.5)'\n          }\n        }\n      }]\n    });\n\n    window.onresize = function () {\n      myChart.resize();\n      myNextChart.resize();\n    };\n  },\n\n  beforeUnmount() {\n    console.log('beforeUnmount');\n\n    if (!this.myChart && !this.myNextChart) {\n      return;\n    } // window.removeEventListener('resize', this.__resizeHandler)\n\n\n    this.myChart.dispose();\n    this.myNextChart.dispose();\n    this.myChart = null;\n    this.myNextChart = null;\n  }\n\n};","map":{"version":3,"mappings":";AAaA;AACA;AACA;AACA;EACAA,eADA;;EAEAC;IACA;MACAC,aADA;MAEA;MACAC,WACA;QAAAC;QAAAJ;MAAA,CADA,EAEA;QAAAI;QAAAJ;MAAA,CAFA,EAGA;QAAAI;QAAAJ;MAAA,CAHA,EAIA;QAAAI;QAAAJ;MAAA,CAJA,EAKA;QAAAI;QAAAJ;MAAA,CALA,CAHA;MAUAK,aAVA;MAWAC,aAXA;MAaAC,aAbA;MAcAC;IAdA;EAgBA,CAnBA;;EAoBAC;IACA;IACAC;MACA;QACA;UAAA;UAAA;;QACA;UAAA;UAAA;;QACA;UAAA;UAAA;;QACA;UAAA;UAAA;;QACA;UAAA;UAAA;MALA,CADA,CAQA;;IACA;;EAXA,CApBA;;EAkCA;IACA;IACAC,sBAFA,CAGA;;IACA;IACAA;IACA,0BANA,CAOA;;IACA;MAAAV;IAAA,6BARA,CASA;;IACA;MACA;MACA;MACA;IACA;;IACAU,4CAfA,CAgBA;;IACA,oEAjBA,CAkBA;;IAEAJ;MACAK;QACAC;MADA,CADA;MAIAC,WAJA;MAKAC;QACAd,oBADA;QAEAD;MAFA,CALA;MASAgB;QACAhB;MADA,CATA;MAYAiB,SACA;QACAjB,UADA;QAEAkB,WAFA;QAGAjB;MAHA,CADA;IAZA;IAoBA;IACAO;MACAI;QACAC,mBADA;QAEAM,eAFA;QAGAC;MAHA,CADA;MAMAN;QACAO;MADA,CANA;MASAC;QACAC,kBADA;QAEAH;MAFA,CATA;MAaAH,SACA;QACAjB,mBADA;QAEAkB,WAFA;QAGAM,aAHA;QAIAvB,mBAJA;QAKAwB;UACAC;YACAC,cADA;YAEAC,gBAFA;YAGAC;UAHA;QADA;MALA,CADA;IAbA;;IA6BAC;MACAvB;MACAC;IACA,CAHA;EAIA,CA5GA;;EA6GAuB;IACApB;;IACA;MACA;IACA,CAJA,CAKA;;;IACA;IACA;IACA;IACA;EACA;;AAvHA","names":["name","data","left_span","sectorSc","value","score_arr","times_arr","myChart","myNextChart","methods","sectorDataFill","console","title","text","tooltip","xAxis","yAxis","series","type","subtext","left","trigger","legend","orient","radius","emphasis","itemStyle","shadowBlur","shadowOffsetX","shadowColor","window","beforeUnmount"],"sourceRoot":"src/views/routes","sources":["my-main.vue"],"sourcesContent":["<template>\r\n    <div class=\"my-main\">\r\n\r\n      <div class=\"left_img\"><div><span>{{left_span}}</span></div></div>\r\n      <div class=\"right_img\">\r\n        <div class=\"top_box\"><div class=\"top_echart\" id=\"photoFirst\" style=\"width: 90%;height:100%;\"></div></div>\r\n        <div class=\"bottom_box\"><div class=\"bottom_echart\" id=\"photoSeconed\" style=\"width: 90%;height:100%;\"></div></div>\r\n\r\n  </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport '@/assets/font/font.css'\r\nimport * as echarts from 'echarts'\r\nimport { getTestFromYiYan, getScoreAndCount, UpdateTokenAPI } from '@/api'\r\nexport default {\r\n  name: 'my-main',\r\n  data () {\r\n    return {\r\n      left_span: '',\r\n      // 表格数据\r\n      sectorSc: [\r\n        { value: 0, name: '<60' },\r\n        { value: 0, name: '60~70' },\r\n        { value: 0, name: '70~80' },\r\n        { value: 0, name: '80~90' },\r\n        { value: 0, name: '90~100' }\r\n      ],\r\n      score_arr: [],\r\n      times_arr: [],\r\n\r\n      myChart: null,\r\n      myNextChart: null\r\n    }\r\n  },\r\n  methods: {\r\n    // 判断数据所处范围进行填充\r\n    sectorDataFill (score) {\r\n      switch (true) {\r\n        case score < 60:this.sectorSc[0].value++; break\r\n        case score >= 60 && score <= 70:this.sectorSc[1].value++; break\r\n        case score > 70 && score <= 80:this.sectorSc[2].value++; break\r\n        case score > 80 && score <= 90:this.sectorSc[3].value++; break\r\n        case score > 90 && score <= 100:this.sectorSc[4].value++; break\r\n      }\r\n      // console.log(this.sectorSc)\r\n    }\r\n\r\n  },\r\n  async mounted () {\r\n    const newToken = await UpdateTokenAPI(this.$store.state.refresh)\r\n    console.log(newToken)\r\n    // 获取一言\r\n    const res = await getTestFromYiYan()\r\n    console.log(res.data)\r\n    this.left_span = res.data\r\n    // 获取次数和分数\r\n    const { data: res1 } = await getScoreAndCount()\r\n    // 数据填入\r\n    for (const item of res1) {\r\n      this.score_arr.push(item.score)\r\n      this.times_arr.push(item.times)\r\n      this.sectorDataFill(item.score)\r\n    }\r\n    console.log(this.score_arr, this.times_arr)\r\n    // 基于准备好的dom，初始化echarts实例\r\n    const myChart = echarts.init(document.getElementById('photoFirst'))\r\n    // 绘制图表\r\n\r\n    myChart.setOption({\r\n      title: {\r\n        text: '预测报告树状图分析结果'\r\n      },\r\n      tooltip: {},\r\n      xAxis: {\r\n        data: this.times_arr,\r\n        name: '次数'\r\n      },\r\n      yAxis: {\r\n        name: '分数'\r\n      },\r\n      series: [\r\n        {\r\n          name: '销量',\r\n          type: 'bar',\r\n          data: this.score_arr\r\n        }\r\n      ]\r\n    })\r\n    const myNextChart = echarts.init(document.getElementById('photoSeconed'))\r\n    myNextChart.setOption({\r\n      title: {\r\n        text: '预测报告扇形图分析结果',\r\n        subtext: '分数范围',\r\n        left: 'center'\r\n      },\r\n      tooltip: {\r\n        trigger: 'item'\r\n      },\r\n      legend: {\r\n        orient: 'vertical',\r\n        left: 'left'\r\n      },\r\n      series: [\r\n        {\r\n          name: 'Access From',\r\n          type: 'pie',\r\n          radius: '50%',\r\n          data: this.sectorSc,\r\n          emphasis: {\r\n            itemStyle: {\r\n              shadowBlur: 10,\r\n              shadowOffsetX: 0,\r\n              shadowColor: 'rgba(0, 0, 0, 0.5)'\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    })\r\n    window.onresize = function () {\r\n      myChart.resize()\r\n      myNextChart.resize()\r\n    }\r\n  },\r\n  beforeUnmount () {\r\n    console.log('beforeUnmount')\r\n    if (!this.myChart && !this.myNextChart) {\r\n      return\r\n    }\r\n    // window.removeEventListener('resize', this.__resizeHandler)\r\n    this.myChart.dispose()\r\n    this.myNextChart.dispose()\r\n    this.myChart = null\r\n    this.myNextChart = null\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n  .my-main{\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: rgb(235, 235, 235);\r\n    border-radius: 1rem;\r\n    display: flex;\r\n    // align-items: center;\r\n    // justify-content: center;\r\n    margin: 0 auto;\r\n    padding: 0 !important;\r\n    .left_img{\r\n      width: 48%;\r\n      height: 90%;\r\n      // margin-bottom: 10%;\r\n      background: url('../../assets/images/夹子便签.png') no-repeat center;\r\n      background-size: 100% 100%;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      >div{\r\n        width: 80%;\r\n        margin: 0 auto;\r\n        // display: flex;\r\n        text-align: center;\r\n        >span{\r\n          font-family: 'scoreFont';\r\n          font-size: 26px;\r\n        }\r\n      }\r\n\r\n    }\r\n    .right_img{\r\n      width: 48%;\r\n      height: 100%;\r\n      display: flex;\r\n      flex-direction: column;\r\n      justify-content: space-around;\r\n      // background-color: red;\r\n      .top_box{\r\n        width: 90%;\r\n        height: 46%;\r\n        border-radius: 28px;\r\n        background-color: white;\r\n        display: flex;\r\n        align-items: center;\r\n      .top_echart{\r\n        // width: 90%;\r\n        // height: 90%;\r\n        margin: 0 auto;\r\n        // border-radius: 1px;\r\n        // >div{\r\n        //   position: relative;\r\n        //   width: 100% !important;\r\n        //   height: 100% !important;\r\n        //   >canvas{\r\n        //     width: 100% !important;\r\n        //     height: 100% !important;\r\n        //   }\r\n        // }\r\n      }\r\n      }\r\n      .bottom_box{\r\n        width: 90%;\r\n        height: 46%;\r\n        border-radius: 28px;\r\n        background-color: white;\r\n        display: flex;\r\n        align-items: center;\r\n        .bottom_echart{\r\n          // width: 90%;\r\n          // height: 90%;\r\n          margin: 0 auto;\r\n        }\r\n      }\r\n\r\n    }\r\n  }\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}